<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="AIDevGallery.Pages.Evaluate.ReviewConfigurationPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:models="using:AIDevGallery.Models"
    mc:Ignorable="d">
    
    <Grid MinHeight="450">
        <ScrollViewer>
            <StackPanel Spacing="24" Padding="0,0,0,24">
                <!-- Header -->
                <TextBlock 
                    Text="Review your evaluation setup before starting" 
                    Style="{StaticResource BodyTextBlockStyle}"
                    Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                
                <!-- Evaluation Overview Section -->
                <Border
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="{StaticResource OverlayCornerRadius}">
                    <Grid Padding="16">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock 
                            Text="Evaluation Overview" 
                            Style="{StaticResource SubtitleTextBlockStyle}"
                            Margin="0,0,0,8"/>
                            
                        <Button
                            Grid.Column="1"
                            Content="Edit"
                            Style="{StaticResource SubtleButtonStyle}"
                            Click="EditEvaluationType_Click"
                            VerticalAlignment="Top"
                            AutomationProperties.Name="Edit evaluation type"/>
                            
                        <StackPanel Grid.Row="1" Grid.ColumnSpan="2" Spacing="4">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE9D9;" FontSize="16" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                                <TextBlock x:Name="EvaluationTypeText" Text="Image Description Quality"/>
                            </StackPanel>
                            <TextBlock x:Name="WorkflowText" Text="Workflow: Test Model (Full Pipeline)" 
                                      Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- Model Configuration Section (Conditional) -->
                <Border
                    x:Name="ModelConfigSection"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="{StaticResource OverlayCornerRadius}">
                    <Grid Padding="16">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock 
                            Text="Model Configuration" 
                            Style="{StaticResource SubtitleTextBlockStyle}"
                            Margin="0,0,0,8"/>
                            
                        <Button
                            Grid.Column="1"
                            Content="Edit"
                            Style="{StaticResource SubtleButtonStyle}"
                            Click="EditModelConfig_Click"
                            VerticalAlignment="Top"
                            AutomationProperties.Name="Edit model configuration"/>
                            
                        <StackPanel Grid.Row="1" Grid.ColumnSpan="2" Spacing="8">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="100"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="Auto"/>
                                </Grid.RowDefinitions>
                                
                                <TextBlock Text="Provider:" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <TextBlock Grid.Column="1" x:Name="ProviderText" Text="OpenAI"/>
                                
                                <TextBlock Grid.Row="1" Text="Model:" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <TextBlock Grid.Row="1" Grid.Column="1" x:Name="ModelText" Text="GPT-4o"/>
                                
                                <TextBlock Grid.Row="2" Text="API Key:" Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <TextBlock Grid.Row="2" Grid.Column="1" x:Name="ApiKeyText" Text="••••••••••1234"/>
                                
                                <TextBlock Grid.Row="3" Text="Prompt:" Foreground="{ThemeResource TextFillColorSecondaryBrush}" Margin="0,8,0,0"/>
                            </Grid>
                            <Border 
                                Background="{ThemeResource LayerOnAcrylicFillColorDefaultBrush}"
                                BorderBrush="{ThemeResource DividerStrokeColorDefaultBrush}"
                                BorderThickness="1"
                                CornerRadius="4"
                                Padding="8">
                                <TextBlock 
                                    x:Name="PromptText" 
                                    Text="Describe this image..." 
                                    TextWrapping="Wrap"
                                    FontStyle="Italic"/>
                            </Border>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- Dataset Section -->
                <Border
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="{StaticResource OverlayCornerRadius}">
                    <Grid Padding="16">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock 
                            Text="Dataset" 
                            Style="{StaticResource SubtitleTextBlockStyle}"
                            Margin="0,0,0,8"/>
                            
                        <Button
                            Grid.Column="1"
                            Content="Edit"
                            Style="{StaticResource SubtleButtonStyle}"
                            Click="EditDataset_Click"
                            VerticalAlignment="Top"
                            AutomationProperties.Name="Edit dataset"/>
                            
                        <StackPanel Grid.Row="1" Grid.ColumnSpan="2" Spacing="8">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon Glyph="&#xE8B7;" FontSize="16" Foreground="{ThemeResource AccentTextFillColorPrimaryBrush}"/>
                                <TextBlock x:Name="DatasetNameText" Text="product_images.jsonl"/>
                            </StackPanel>
                            <TextBlock x:Name="DatasetCountText" Text="847 valid images" 
                                      Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            
                            <!-- Folder Organization (if applicable) -->
                            <StackPanel x:Name="FolderOrgPanel" Visibility="Collapsed" Spacing="4">
                                <TextBlock Text="Folder Organization:" 
                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"
                                          Margin="0,8,0,4"/>
                                <ItemsControl x:Name="FoldersList" Margin="16,0,0,0">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding}" 
                                                      Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- Evaluation Methods Section (Conditional) -->
                <Border
                    x:Name="MetricsSection"
                    Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
                    BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="1"
                    CornerRadius="{StaticResource OverlayCornerRadius}">
                    <Grid Padding="16">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        
                        <TextBlock 
                            Text="Evaluation Methods" 
                            Style="{StaticResource SubtitleTextBlockStyle}"
                            Margin="0,0,0,8"/>
                            
                        <Button
                            Grid.Column="1"
                            Content="Edit"
                            Style="{StaticResource SubtleButtonStyle}"
                            Click="EditMetrics_Click"
                            VerticalAlignment="Top"
                            AutomationProperties.Name="Edit evaluation methods"/>
                            
                        <StackPanel Grid.Row="1" Grid.ColumnSpan="2" Spacing="8">
                            <!-- Automated Metrics -->
                            <TextBlock Text="Automated Metrics:" 
                                      Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                            <ItemsControl x:Name="AutomatedMetricsList" Margin="16,0,0,0">
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Spacing="8">
                                            <FontIcon Glyph="{Binding Icon}" FontSize="14" 
                                                     Foreground="{Binding IconColor}"/>
                                            <TextBlock Text="{Binding Name}" 
                                                      Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                            
                            <!-- AI Judge Criteria -->
                            <StackPanel x:Name="AIJudgePanel" Visibility="Collapsed" Spacing="4" Margin="0,8,0,0">
                                <TextBlock x:Name="AIJudgeHeaderText" Text="AI Judge Criteria (2):" 
                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                <ItemsControl x:Name="CriteriaList" Margin="16,0,0,0">
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel Spacing="2">
                                                <TextBlock Text="{Binding Name}" FontWeight="SemiBold"/>
                                                <TextBlock Text="{Binding Description}" 
                                                          TextWrapping="Wrap"
                                                          FontSize="12"
                                                          Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </StackPanel>
                        </StackPanel>
                    </Grid>
                </Border>
                
                <!-- Execution Estimate Section -->
                <Border
                    Background="{ThemeResource SystemFillColorAttentionBackgroundBrush}"
                    BorderBrush="{ThemeResource SystemFillColorAttentionBrush}"
                    BorderThickness="1"
                    CornerRadius="{StaticResource OverlayCornerRadius}">
                    <StackPanel Padding="16" Spacing="4">
                        <StackPanel Orientation="Horizontal" Spacing="8">
                            <FontIcon Glyph="&#xE121;" FontSize="16" Foreground="{ThemeResource SystemFillColorAttentionBrush}"/>
                            <TextBlock x:Name="TimeEstimateText" Text="Estimated time: ~15 minutes"/>
                        </StackPanel>
                        <TextBlock x:Name="TimeEstimateDetailsText" 
                                  Text="Based on 847 images with 2 metrics + AI Judge" 
                                  FontSize="12"
                                  Foreground="{ThemeResource TextFillColorSecondaryBrush}"/>
                    </StackPanel>
                </Border>
                
                <!-- Large Dataset Warning (Conditional) -->
                <InfoBar
                    x:Name="LargeDatasetWarning"
                    IsOpen="False"
                    Severity="Warning"
                    Title="Large Dataset"
                    Message="This evaluation may take significant time to complete. Consider running it when you don't need your computer for other tasks."/>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Page>